program  : p=instruction* { p };

instruction
    :  i=ID COLON { "jmp_point", i.value };
    :  opcode=INSTRUCTION params=params { (opcode.value, params) };

params  :  first=factor rest=(COMMA factor)* { process_params(first, rest) };

factor
    :  LPAREN i=factor RPAREN { ("addr", i) };
    :  i=ID { ("reg" if i.value.lower() in REGISTERS else "jmp_pointer", i.value) };
    :  i=num { i };

num  :  i= INT | HEX | BIN { ("cv", i.value) };